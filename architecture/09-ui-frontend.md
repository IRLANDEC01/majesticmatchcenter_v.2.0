# UI и Фронтенд: Стратегия и Архитектура

## 1. Философия и Принципы

Цель — создать быстрый, функциональный и удобный интерфейс, разделенный на две ключевые зоны:

1.  **Административная панель:** Приоритет — максимальная функциональность, скорость работы и удобство для администратора. Чистые, управляемые формы и наглядное представление данных.
2.  **Публичный портал:** "Аналитический центр" для фанатов. Современный, строгий дизайн в стиле "стекломорфизм", с акцентом на данных (статистика, таблицы, профили). Никакой пользовательской регистрации или интерактивных форм.

## 2. Технологический стек и Дизайн-система

### 2.1. Основной стек

*   **Фреймворк:** Next.js 15+ (с App Router)
*   **Библиотека:** React 19+
*   **Стилизация:** Tailwind CSS
*   **Компоненты:** **shadcn/ui** (копируются в проект для полного контроля)
*   **Формы:** **React Hook Form** + **Zod** (для сквозной валидации)
*   **Запросы к API:** **TanStack Query v5** (для кэширования и получения данных на клиенте)
*   **Иконки:** **lucide-react**
*   **Даты и время:** **date-fns**

### 2.2. Дизайн-система

*   **Тема:** **Темная**. Основной фон — палитра `Zinc` из Tailwind CSS (темно-серый, не черный).
*   **Акцентный цвет:** **Синий (`Blue`)**. Используется для кнопок, ссылок, активных элементов.
*   **Стиль публичной части:** **Стекломорфизм (Glassmorphism)**. Эффект достигается через `backdrop-blur`, полупрозрачные фоны и тонкие границы.
*   **Типографика:** Шрифт Inter для всего текста.

## 3. Архитектура и Паттерны (Next.js 15.3 и React 19)

Мы будем активно использовать самые современные возможности фреймворка и библиотеки для достижения максимальной производительности и чистоты кода.

### 3.1. React 19: Ключевые паттерны

*   **Actions:** Для всех форм в админ-панели мы будем использовать React Actions. Это позволит вызывать серверную логику (например, `createMapTemplate`) напрямую из клиентских компонентов форм, упрощая обработку данных, состояний загрузки и ошибок. `useFormState` и `useFormStatus` из React DOM станут нашими основшими инструментами для обратной связи с пользователем.
*   **`use` Hook:** Будем использовать новый хук `use` для более чистого и линейного кода при работе с промисами (например, внутри клиентских компонентов, получающих данные через `TanStack Query`) и контекстом.
*   **React Compiler (на перспективу):** Мы будем писать простой и понятный код без избыточной ручной мемоизации (`useMemo`, `useCallback`). Наша архитектура готова к будущему React Compiler, который возьмет на себя оптимизацию перерисовок автоматически.

### 3.2. Next.js 15.3: Ключевые паттерны

*   **App Router:** Мы полностью полагаемся на App Router для структурирования приложения.
    *   **Вложенные лейауты:** Используем для создания общего каркаса админ-панели (`src/app/admin/layout.js`) и публичной части.
    *   **Группы маршрутов:** Для логической организации, не влияющей на URL.
*   **Серверные Компоненты по умолчанию:** Это наш основной подход. Большинство страниц и компонентов (особенно на публичном портале) будут серверными для максимальной производительности (меньше JS на клиенте). Интерактивные части будут выноситься в Клиентские Компоненты (`'use client'`).
*   **Partial Prerendering (PPR) на перспективу:** Наша архитектура идеально подходит для PPR. Публичные страницы (например, профиль игрока) могут иметь статическую "оболочку" (лейаут, шапка), а динамические данные (статистика) будут стримиться по мере готовности, обеспечивая мгновенную загрузку.
*   **Route Handlers:** Остаются нашим основным способом создания бэкенд API (`/api/...`).
*   **Асинхронные API для маршрутов (Критически важно!):** В Next.js 15 динамические API, такие как `params` и `searchParams` в обработчиках маршрутов (`route.js`) и на страницах, **стали асинхронными**. Это означает, что для получения доступа к их значениям, необходимо использовать `await`. Прямой синхронный доступ приведет к ошибке во время выполнения.
    ```javascript
    // Правильный паттерн в route.js
    export async function GET(request, { params }) {
      const { id } = await params; // Обязательно использовать await!
      // ... остальная логика
    }
    ```

## 4. План реализации

Реализация будет проходить итерационно, по четко определенным шагам.

*   **Шаг 1: Настройка окружения.**
    *   Установка всех npm-пакетов, перечисленных в стеке.
    *   Инициализация `shadcn/ui` с темой `Zinc` и акцентным цветом `Blue`.

*   **Шаг 2: Создание базового лейаута админ-панели.**
    *   Создание общего лейаута админки с боковой навигацией (`AdminSidebar`) и основной областью для контента.

*   **Шаг 3: Реализация загрузки изображений (Двухэтапный подход).**
    1.  **Фаза 1 (Прототип):** Создается полнофункциональный на фронтенде компонент `ImageUploader` (с выбором файла и превью). При сохранении формы он отправляет на бэкенд путь к стандартной картинке-заглушке. **Это позволяет не блокировать разработку UI.**
    2.  **Фаза 2 (Интеграция):** После готовности основного UI, реализуется бэкенд-логика для работы с S3-хранилищем от **REG.RU** (генерация pre-signed URLs). Компонент `ImageUploader` обновляется для реальной загрузки файлов.

*   **Шаг 4: Разработка CRUD-операций в админ-панели.**
    *   Начинаем с самой простой сущности (например, `MapTemplate`).
    *   Создаем страницу со списком в виде таблицы (`/admin/map-templates`).
    *   Создаем страницу с формой создания/редактирования (`/admin/map-templates/new`, `/admin/map-templates/[id]/edit`).
    *   Повторяем для всех остальных сущностей (Семьи, Игроки, Турниры и т.д.).

*   **Шаг 5: Разработка публичных страниц.**
    *   После того как контент можно будет создавать через админку, начинаем верстать "витрину".
    *   Пример: страница профиля игрока (`/players/[slug]`), страница турнира (`/tournaments/[id]`), используя дизайн "стекломорфизм".
