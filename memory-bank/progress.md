# Progress Tracker

## Этап 0: Планирование и архитектура

- **[✓]** Проанализирована первоначальная архитектурная документация.
- **[✓]** Выявлены потенциальные проблемы и предложены улучшения.
- **[✓]** Проведена реструктуризация и обновление документации в `architecture/`.
- **[✓]** `Memory Bank` создан и синхронизирован с финальной архитектурой.

## Этап 1: Инициализация и базовые модели

- **[✓]** Создана базовая структура каталогов проекта.
- **[✓]** Инициализировано Next.js приложение и настроены базовые конфигурации.
- **[✓]** Настроен Docker Compose для локальной разработки.
- **[✓]** Настроен `migrate-mongo`.
- **[✓]** Реализована базовая абстракция для кэша (`getCacheAdapter`) с Redis.
- **[✓]** Реализован базовый логгер (Winston).
- **[✓]** Созданы Mongoose модели для всех ключевых сущностей (Tournament, Map, Player, Family и их сателлиты).
- **[✓]** Настроена тестовая среда Jest для работы с ESM-модулями.
- **[✓]** Реализована логика генерации `slug` для турниров и карт в доменных сервисах (`TournamentService`, `MapService`).

## Этап 2: Рефакторинг - Мягкое удаление (`archivedAt`)

- **Цель:** Заменить разрозненные статусы на единое поле `archivedAt` для унифицированного механизма мягкого удаления.
- **Статус:** **[ЗАВЕРШЕНО]**

- **Выполнено:**
  - **[✓]** **Player:** Модель, репозиторий, сервис и API-маршруты.
  - **[✓]** **Family:** Модель, репозиторий, сервис и API-маршруты.
  - **[✓]** **Tournament:** Модель, репозиторий, сервис и API-маршруты.
  - **[✓]** **Map:** Модель, репозиторий, сервис и API-маршруты.
  - **[✓]** **TournamentTemplate:** Модель, репозиторий, сервис и API-маршруты.
  - **[✓]** **MapTemplate:** Модель, репозиторий, сервис и API-маршруты.
  - **[✓]** Все связанные сущности проверены и обновлены.

## Этап 3: Завершение Карты и Управление Статистикой

- **[✓]** Реализованы эндпоинты `GET`, `PUT` для `/api/admin/tournaments/[id]`.
- **[✓]** Реализованы эндпоинты `GET`, `POST` для `/api/admin/maps`.
- **[✓]** Реализованы эндпоинты `GET`, `PUT`, `PATCH` для `/api/admin/maps/[id]`.
- **[✓]** Реализована логика автоматической смены статуса `planned`/`active` для карт.

- **[✓]** Реализован метод для агрегации статистики турнира (`Aggregation Pipeline`) в `TournamentRepository`.
- **[✓]** Созданы API-маршруты (Route Handlers) для управления турнирами (CRUD).
- **[✓]** Реализовать логику загрузки и парсинга статистики из JSON-файла на странице карты.
- **[✓]** Реализовать процесс завершения карты с обновлением статистики игроков и семей.

## Этап 4: Жизненный цикл Турнира

- **[✓]** Реализовать логику завершения турнира.
- **[✓]** Реализовать начисление призов.

## Этап 5: API

- **[✓]** Реализован эндпоинт `POST /api/admin/tournaments` для создания турниров.
- **[✓]** Реализованы эндпоинты `GET`, `PUT`, `DELETE` для `/api/admin/tournaments/[id]`.
- **[✓]** Реализовать эндпоинт `GET /api/public/tournaments/[slug]/stats` для получения статистики турнира.

## В процессе (In Progress)

### Архитектура и Рефакторинг
- [ ] **Рефакторинг эндпоинтов архивации `Tournaments`**: Перевести эндпоинт на `PATCH /.../[id]/archive`.

### Функционал
- [ ] **Реализовать создание сущности "Новости" (News)**: Модель, репозиторий, сервис и API-маршруты.

## Готово (Done)
*Этот раздел объединен с основными этапами для устранения дублирования.* 